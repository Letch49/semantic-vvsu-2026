# Задача 2: Нейронные сети и анализ тональности

## Описание задачи

В данной задаче вам предстоит реализовать простую полносвязную нейронную сеть (fully connected neural network) **с нуля** для решения задачи классификации или регрессии.

### Цель задачи

Реализовать нейронную сеть с возможностью обучения, предсказания и оценки качества на примере **анализа тональности текстов** (положительная/отрицательная/нейтральная) или другой задачи классификации/регрессии.

**Основные примеры использования**: 
- Анализ тональности текстовых отзывов (классификация: положительная/отрицательная/нейтральная)
- Предсказание рейтинга отзывов от 0 до 10 (регрессия)

### Что нужно сделать

1. **Подготовить данные для анализа тональности**:
   - Векторизовать текстовые отзывы (использовать TF-IDF или Bag of Words)
   - Разделить данные на обучающую и тестовую выборки

2. **Реализовать класс нейронной сети** с методами:
   - `.fit(X, y)` - обучение сети
   - `.predict(X)` - предсказание классов/значений
   - `.predict_proba(X)` - предсказание вероятностей (для классификации)

3. **Реализовать основные компоненты**:
   - Полносвязные слои (fully connected layers)
   - Функции активации (ReLU, sigmoid, softmax)
   - Функцию потерь (logloss для классификации)
   - Обратное распространение ошибки (backpropagation)
   - Оптимизатор (например, градиентный спуск)

4. **Обучить модель на данных тональности**:
   - Бинарная классификация: положительная/отрицательная тональность
   - Мультиклассовая классификация: положительная/отрицательная/нейтральная (+2 балла)
   - Регрессия: предсказание рейтинга отзывов от 0 до 10 (максимум 8/10 баллов)

5. **Оценить качество модели**:
   - Для классификации: F1-score, Precision, Recall
   - Для регрессии: MAE (средняя абсолютная ошибка в баллах), RMSE, MAPE

6. **Написать объяснение** как работает ваша реализация

### Технические требования

#### Разрешенные библиотеки:
- `numpy` - для работы с массивами и математических операций
- `scikit-learn` - для метрик оценки, генерации данных и векторизации текстов (TfidfVectorizer)
- `pandas` - для работы с данными (опционально)
- Стандартные библиотеки Python
- **Запрещено**: использовать готовые фреймворки для нейронных сетей (TensorFlow, PyTorch, Keras) для реализации самой сети
- **Разрешено**: использовать готовые фреймворки только для примеров и сравнения результатов

#### Что нужно реализовать:

1. **Класс нейронной сети** со следующей структурой:
```python
class NeuralNetwork:
    def __init__(self, layers, activation='relu', dropout_rate=0.0):
        # Инициализация весов, слоев и т.д.
        pass
    
    def fit(self, X, y, epochs=100, batch_size=32, learning_rate=0.01, 
            validation_data=None, early_stopping=False):
        # Обучение сети
        pass
    
    def predict(self, X):
        # Предсказание классов/значений
        pass
    
    def predict_proba(self, X):
        # Предсказание вероятностей (для классификации)
        pass
```

2. **Функцию потерь**:
   - Для классификации: logloss (binary cross-entropy или categorical cross-entropy)
   - Для регрессии: любая (MSE, MAE и т.д.)

3. **Метрики оценки**:
   - Для классификации: F1-score, Precision, Recall
   - Для регрессии: MAE, RMSE, MAPE

### Критерии оценки (10 баллов)

#### Базовые требования (8 баллов):
- **2 балла**: Корректная реализация полносвязных слоев и forward pass
- **2 балла**: Реализация backpropagation и обучения сети
- **2 балла**: Реализация функции потерь (logloss для классификации)
- **1 балл**: Корректная работа методов `.fit()`, `.predict()`, `.predict_proba()`
- **1 балл**: Правильный расчет метрик оценки (F1, Precision, Recall для классификации или MAE, RMSE, MAPE для регрессии)

#### Дополнительные баллы:
- **+2 балла**: Реализация dropout
- **+2 балла**: Реализация early stopping
- **+2 балла**: Поддержка мультиклассовой классификации (3+ классов)
- **+1 балл**: Качественное объяснение работы сети (как работает forward pass, backpropagation, dropout, early stopping)

**Максимальный балл**: 10 баллов (8 базовых + 2 за мультиклассовую классификацию)

**Примечание**: Для регрессии максимальный балл - 8/10 (без мультиклассовой классификации)

### Формат сдачи

1. Файл `task2-solution.ipynb` с реализацией нейронной сети
2. Файл `report.md` с описанием:
   - Архитектуры сети
   - Объяснением работы forward pass и backpropagation
   - Объяснением работы dropout и early stopping (если реализованы)
   - Анализа результатов обучения
   - Выводов о качестве модели

### Полезные ссылки

- [Backpropagation explained](https://en.wikipedia.org/wiki/Backpropagation)
- [Dropout regularization](https://en.wikipedia.org/wiki/Dilution_(neural_networks))
- [Early stopping](https://en.wikipedia.org/wiki/Early_stopping)
- [Scikit-learn metrics](https://scikit-learn.org/stable/modules/model_evaluation.html)

### Примеры ожидаемых результатов

После выполнения задачи вы должны получить:
- Работающую нейронную сеть, обученную на данных (Любые данные задачи классификации/регрессии)
- Метрики качества модели
- Графики обучения (loss по эпохам)
- Объяснение работы всех компонентов

### Вопросы для размышления

1. Как работает forward pass в нейронной сети?
2. Как работает backpropagation?
3. Зачем нужен dropout и как он работает?
4. Как early stopping помогает предотвратить переобучение?